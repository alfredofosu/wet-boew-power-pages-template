{%- assign cdtsVersion = settings['GCWeb/App/Version'] | default:"v5_0_4"-%}
{%- assign cdtsTemplatesUrl = settings['GCWeb/App/BaseURL'] | default:"https://www.canada.ca/etc/designs/canada/cdts/gcweb/" -%}

<nav aria-label="Skip Links">
	<ul id="wb-tphp" class="wb-init wb-disable-inited">
		<li class="wb-slc">
			<a class="wb-sl" href="#wb-cont">
				Skip to main content
			</a>
		</li>
		<li class="wb-slc visible-xs visible-sm visible-md visible-lg">
			<a class="wb-sl" href="#wb-info">
				Skip to "About government"
			</a>
		</li>
		<li class="wb-slc">
			<a class="wb-sl" href="?wbdisable=true" rel="alternate">
				Switch to basic HTML version
			</a>
		</li>
	</ul>
</nav>
<header aria-label="Government of Canada">
	<div id="wb-bnr" class="container">
		<div class="row">
			<!-- Set current language URL substitution -->
			{% assign ordered_languages = page.languages | order_by: "name" %}
			{% for language in ordered_languages %}
				{% if language.code == "en" %}
					{% assign en_url_substitution = language.url_substitution %}
					{% assign en_name = language.name %}
					{% assign en_code = language.code %}
				{% elsif language.code == "fr" %}
					{% assign fr_url_substitution = language.url_substitution %}
					{% assign fr_name = language.name %}
					{% assign fr_code = language.code %}
				{% endif %}
			{% endfor %}
			<section id="wb-lng" class="col-xs-3 col-sm-12 pull-right text-right">
				<h2 class="wb-inv">Language selection</h2>
				<ul class="list-inline mrgn-bttm-0">
					<li>
						{% if website.selected_language.code == "en" %}
						<a lang="{{- fr_code -}}" href="/{{- fr_url_substitution -}}">
							<span class="hidden-xs">{{ fr_name | escape }}</span>
							<abbr title="{{ fr_name | escape }}" class="visible-xs h3 mrgn-tp-sm mrgn-bttm-0 text-uppercase">{{- fr_code -}}</abbr>
						</a>
						{% else %}
						<a lang="{{- en_code -}}" href="/{{- en_url_substitution -}}">
							<span class="hidden-xs">{{ en_name | escape }}</span>
							<abbr title="{{ en_name | escape }}" class="visible-xs h3 mrgn-tp-sm mrgn-bttm-0 text-uppercase">{{- en_code -}}</abbr>
						</a>
						{% endif %}
					</li>
				</ul>
			</section>
			<div class="brand col-xs-9 col-sm-5 col-md-4" property="publisher" typeof="GovernmentOrganization">
				<img src="{{- cdtsTemplatesUrl -}}{{- cdtsVersion -}}/wet-boew/assets/sig-blk-en.svg"
					alt="Government of Canada" property="logo">
				<span class="wb-inv"> / <span lang="fr">Gouvernement du Canada</span></span>
				<meta property="name" content="Government of Canada">
				<meta property="areaServed" typeof="Country" content="Canada">
				<link property="logo"
					href="{{- cdtsTemplatesUrl -}}{{- cdtsVersion -}}/wet-boew/assets/wmms-blk.svg">
			</div>
			<!-- Search Bar -->
			{% assign search_enabled = settings['Search/Enabled'] | boolean | default:true %}
			{% if search_enabled %}
			<section id="wb-srch"
				class="col-lg-offset-4 col-md-offset-4 col-sm-offset-2 col-xs-12 col-sm-5 col-md-4 visible-md visible-lg">
				<h2>Search Canada.ca</h2>
				<form action="https://www.canada.ca/en/sr/srb.html" method="get" name="cse-search-box" role="search"
					aria-label="Search Criteria">
					<div class="form-group wb-srch-qry">
						<label for="wb-srch-q" class="wb-inv">Search Canada.ca</label>
						<input id="wb-srch-q" class="wb-srch-q form-control" name="q" type="search" value="" size="34"
							maxlength="170" placeholder="Search Canada.ca">
						<input type="hidden" name="cdn" value="canada">
					</div>
					<div class="form-group submit">
						<button type="submit" id="wb-srch-sub" class="btn btn-primary btn-small"
							name="wb-srch-sub"><span class="glyphicon-search glyphicon"></span><span
								class="wb-inv">Search Canada.ca</span></button>
					</div>
				</form>
			</section>
			{% endif %}
		</div>
	</div>
	<div class="app-bar">
		<div class="container">
			<div class="row">
				<!-- Application Name -->
				<section class="col-xs-12">
					<h2 class="wb-inv">Name of Web application</h2>
					<a class="app-name" href="#">{{- snippets['GCWeb/App/Name'] -}}</a>
				</section>
				<!-- Login Details -->
				{%- assign profile_enabled = settings['Profile/Enabled'] | boolean | default: true -%}
                {%- if profile_enabled -%}
				<nav class="col-sm-8 hidden-xs hidden-print" aria-label="Account menu.">
					<h2 class="wb-inv" id="cdts-hiddenAccountMenu">Account menu</h2>
					<ul class="app-list-account list-unstyled">
						{%- if user -%}
						<li>
							<a class="btn" aria-label="{{ snippets['GCWeb/App/AccountSettingsText'] | default:resx['Profile_Text'] | escape }}" 
								aria-roledescription="link" href="{{ sitemarkers['Profile'].url | escape }}" title="{{ snippets['GCWeb/App/AccountSettingsText'] | default:resx['Profile_Text'] | escape }}">
								<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> 
								{{ snippets['GCWeb/App/AccountSettingsText'] | default:resx['Profile_Text'] | escape }}
							</a>
						</li>
						<li>
							<a id="cdts-signout-btn" class="btn" aria-label="{{ snippets['GCWeb/App/SignOutText'] | default:resx['Sign_Out'] | escape }}" 
								aria-roledescription="link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_out_url_substitution }}">
								<span class="glyphicon glyphicon-off" aria-hidden="true"></span> 
								{{ snippets['GCWeb/App/SignOutText'] | default:resx['Sign_Out'] | escape }}
							</a>
						</li>
						{%- else -%}
						<li>
							<a id="cdts-signin-btn" class="btn" aria-label="{{ snippets['GCWeb/App/SignInText'] | default:resx['Sign_In'] | escape }}" 
								aria-roledescription="link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_in_url_substitution }}">
								<span class="glyphicon glyphicon-off" aria-hidden="true"></span> 
								{{ snippets['GCWeb/App/SignInText'] | default:resx['Sign_In'] | escape }}
							</a>
						</li>
						{%- endif -%}
					</ul>
				</nav>
				{%- endif -%}
			</div>
		</div>
	</div>
	<!-- START: MOBILE PANEL-->
	<div class="app-bar-mb visible-xs-block hidden-print">
		<div class="container">
			<nav aria-labelledby="cdts-hiddenMenu">
				<h2 class="wb-inv" id="cdts-hiddenMenu">Menu</h2>
				<ul class="app-list-main list-unstyled">
					<li class="wb-mb-links" id="wb-glb-mn">
						<a href="#mb-pnl" aria-controls="mb-pnl" class="btn overlay-lnk" role="button">Menu</a>
						<h2>Menu</h2>
					</li>
				</ul>
				<!-- Build Menu here -->
				<div id="mb-pnl"></div>
			</nav>
			<nav aria-labelledby="cdts-hiddenSearch">
				<h2 class="wb-inv" id="cdts-hiddenSearch">Search</h2>
				<ul class="app-list-main list-unstyled">
					<li>
						<a href="#app-srch-mb" title="Search" aria-controls="app-srch-mb" class="btn overlay-lnk" role="button">
							<span class="glyphicon-search glyphicon" aria-hidden="true"></span>
							<span class="wb-inv">Search</span>
						</a>
					</li>
				</ul>
				{% assign search_enabled = settings['Search/Enabled'] | boolean | default:true %}
				{% if search_enabled %}
				<section id="app-srch-mb" class="wb-overlay modal-content overlay-def wb-bar-t">
					<div class="modal-header">
						<h3 class="modal-title">Search Canada.ca</h3>
					</div>
					<div class="modal-body">
						<form action="https://www.canada.ca/en/sr/srb.html" method="get" name="cse-search-box" role="search"
							class="form-inline" aria-label="Search Criteria.">
							<div class="input-group">
								<label for="app-wb-srch-q" class="wb-inv">Search Canada.ca</label>
								<input placeholder="Search Canada.ca" id="app-wb-srch-q" class="app-srch-q-mb form-control" name="q"
									type="search" value="" size="27" maxlength="150">
								<input type="hidden" name="cdn" value="canada">
								<span class="input-group-btn">
									<button type="submit" id="app-srch-sub-mb" class="btn btn-primary btn-small"
										name="app-srch-sub-mb">
										<span class="glyphicon-search glyphicon"></span>
										<span class="wb-inv">Search</span>
									</button>
								</span>
							</div>
						</form>
					</div>
					<button title="Close: Search Canada.ca (escape key)" class="mfp-close overlay-close" type="button">Ã—<span
							class="wb-inv"> Close: Search Canada.ca (escape key)</span></button>
				</section>
				{% endif %}
			</nav>
			{%- assign profile_enabled = settings['Profile/Enabled'] | boolean | default: true -%}
            {%- if profile_enabled -%}
			<nav aria-labelledby="cdts-accountMenu">
				<h2 class="wb-inv" id="cdts-accountMenu">Account menu</h2>
				<ul class="app-list-account list-unstyled">
					{%- if user -%}
					<li>
						<a href="#" class="btn" aria-label="{{ snippets['GCWeb/App/AccountSettingsText'] | default:resx['Profile_Text'] | escape }}" 
							aria-roledescription="link" href="{{ sitemarkers['Profile'].url | escape }}" title="{{ snippets['GCWeb/App/AccountSettingsText'] | default:resx['Profile_Text'] | escape }}">
							<span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
							{{ snippets['GCWeb/App/AccountSettingsText'] | default:resx['Profile_Text'] | escape }}
						</a>
					</li>
					<li>
						<a href="#" id="cdts-signout-btn-mobile" class="btn" aria-label="{{ snippets['GCWeb/App/SignOutText'] | default:resx['Sign_Out'] | escape }}" 
							aria-roledescription="link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_out_url_substitution }}">
							<span class="glyphicon glyphicon-off" aria-hidden="true"></span>
							{{ snippets['GCWeb/App/SignOutText'] | default:resx['Sign_Out'] | escape }}
						</a>
					</li>
					{%- else -%}
					<li>
						<a href="#" id="cdts-signin-btn-mobile" class="btn" aria-label="{{ snippets['GCWeb/App/SignInText'] | default:resx['Sign_In'] | escape }}" 
							aria-roledescription="link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_in_url_substitution }}">
							<span class="glyphicon glyphicon-off" aria-hidden="true"></span>
							{{ snippets['GCWeb/App/SignInText'] | default:resx['Sign_In'] | escape }}
						</a>
					</li>
					{%- endif -%}
				</ul>
			</nav>
			{%- endif -%}
		</div>
	</div>
	<!-- END: MOBILE PANEL-->
	{% assign primary_nav = weblinks['Default'] %}
	{% if primary_nav %}
	<nav id="wb-sm" data-trgt="mb-pnl" class="wb-menu visible-md visible-lg" data-trgt="mb-pnl" typeof="SiteNavigationElement" aria-labelledby="appNavMenu">
		<div class="pnl-strt container nvbar">
			<h2 class="wb-inv" id="appNavMenu">Main navigation menu</h2>
			<div class="row">
				<ul class="list-inline menu cdts-background-initial" role="menubar">
					{% for link in primary_nav.weblinks %}
					{% assign sublinks = nil %}
					{% if link.display_page_child_links and link.url %}
					{% assign sublinks = sitemap[link.url].children %}
					{% else %}
					{% assign sublinks = link.weblinks %}
					{% endif %}
					{% assign has_submenu = sublinks.size > 0 | boolean %}
					<li role="none">
						{% if has_submenu %}
						<a href="{{ link.url | escape }}" class="item" role="menuitem" aria-haspopup="true"
							{% if link.Open_In_New_Window %} target="_blank" {% endif %}
							{% if link.nofollow %} rel="nofollow" {% endif %}
							{% if link.tooltip %} title="{{ link.tooltip | escape }}" {% endif %}>
							{{ link.name | escape }}
						</a>
						<ul class="sm list-unstyled" role="menu">
							{% for sublink in sublinks %}
							<li role="none">
								<a href="{{ sublink.link }}" role="menuitem"
									{% if sublink.Open_In_New_Window %} target="_blank" {% endif %}
									{% if sublink.nofollow %} rel="nofollow" {% endif %}
									{% if sublink.tooltip %} title="{{ sublink.tooltip | escape }}" {% endif %}>
									{{ sublink.name | default:sublink.title | escape }}
								</a>
							</li>
							{% endfor %}
						</ul>
						{% else %}
						<a href="{{ link.url | escape }}" class="item" role="menuitem"
							{% if link.Open_In_New_Window %} target="_blank" {% endif %}
							{% if link.nofollow %} rel="nofollow" {% endif %}
							{% if link.tooltip %} title="{{ link.tooltip | escape }}" {% endif %}>
							{{ link.name | escape }}
						</a>
						{% endif %}
					</li>
					{% endfor %}
				</ul>
			</div>
		</div>
	</nav>
	{% endif %}
	{% substitution %}
	<nav id="wb-bc" property="breadcrumb" aria-labelledby="breadcrumbPosition">
		<h2 id="breadcrumbPosition">You are here:</h2>
		<div class="container">
			{%- assign title = title | default: page.title -%}
			<ol class="breadcrumb">
				{%- for crumb in page.breadcrumbs -%}
				<li>
					<a href="{{- crumb.url | h -}}" aria-label="{{- crumb.title | h -}}">{{- crumb.title | truncate: 24 | h -}}</a>
				</li>
				{%- endfor -%}
    			<li class="active">
					{%- block activebreadcrumb -%}{{- title | h -}}{%- endblock -%}
				</li>
			</ol>
		</div>
	</nav>
	{% endsubstitution %}
</header>